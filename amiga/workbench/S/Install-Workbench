; Install Workbench
; -----------------
;
; Date: 2017-08-10
; Author: Henrik Noerfjand Stengaard


; Clear screen
cls 


echo "Workbench Installation"
echo "----------------------"


; Assign FMS to install temp dir, if self install prefs exists. Otherwise assign FMS to T:
IF EXISTS INSTALLDIR:Prefs/Self-Install
  ; Create fms temp directory, if it doesn't exist
  IF NOT EXISTS "INSTALLDIR:Temp/FMS"
    makepath >NIL: "INSTALLDIR:Temp/FMS"
  ENDIF

  ; Assign FMS: to fms temp directory, if it doesn't exist
  Assign >NIL: EXISTS FMS:
  IF WARN
    assign >NIL: FMS: INSTALLDIR:Temp/FMS
  ENDIF
ELSE
  ; Assign FMS: to T:, if it doesn't exist
  Assign >NIL: EXISTS FMS:
  IF WARN
    assign >NIL: FMS: T:
  ENDIF
ENDIF


; Mount FF0:, if it doesn't exist
Assign >NIL: EXISTS FF0:
IF WARN
  Mount FF0: FROM INSTALLDIR:Devs/Mountlist
ENDIF


; Create workbench directory, if it doesn't exist
IF NOT EXISTS "INSTALLDIR:Workbench/"
  makepath >NIL: "INSTALLDIR:Workbench"
ENDIF


; Find, install workbench from adf and fallback to disk, if self install prefs exists. Otherwise install workbench adf
IF EXISTS INSTALLDIR:Prefs/Self-Install
  ; Delete existing files from workbench directory
  Delete >NIL: "INSTALLDIR:Workbench/#?"

  ; Delete install workbench adf prefs, if it exists
  IF EXISTS "INSTALLDIR:Prefs/Install-Workbench-Adf"
    Delete >NIL: "INSTALLDIR:Prefs/Install-Workbench-Adf"
  ENDIF

  ; Run find workbench adf, if WORKBENCHDIR: exists
  Assign >NIL: EXISTS WORKBENCHDIR:
  IF NOT WARN
    execute "INSTALLDIR:S/Find-Workbench-Adf"
  ENDIF

  ; Run install workbench adf, if prefs exists
  IF EXISTS INSTALLDIR:Prefs/Install-Workbench-Adf
    execute "INSTALLDIR:S/Install-Workbench-Adf"
  ELSE
    execute "INSTALLDIR:S/Install-Workbench-Disk"
  ENDIF
ELSE
  execute "INSTALLDIR:S/Install-Workbench-Adf"
ENDIF


echo ""
echo "Workbench installation is complete."
echo ""
ask "Press ENTER to continue"